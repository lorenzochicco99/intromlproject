Data loaded correctly
number of classes 70
Optimizer Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0.1
Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    weight_decay: 0.1
)
Training phase ...
2024-05-28 20:34:49,467 - training_logger - INFO - Configurations: {'root': '/home/disi/ml', 'img_folder': 'aircraft', 'model_name': 'efficientnetv2', 'data_dir': '/home/disi/ml/datasets/aircraft', 'dataset_name': 'aircraft', 'checkpoint': None, 'save_dir': '/home/disi/ml/checkpoints/efficientnetv2_aircraft_try', 'project_name': 'efficientnetv2_test', 'image_size': 224, 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225], 'batch_size': 32, 'epochs': 20, 'optimizer': 'AdamW', 'optimizer_type': 'custom', 'learning_rate': 0.01, 'weight_decay': 0.1, 'momentum': 0.736045219441998, 'criterion': 'CrossEntropyLoss', 'scheduler': True, 'step_size': 10, 'patience': 5, 'dropout_rate': 0.3317332509897824, 'device': 'cuda'}
Epoch 1 - Training:   0%|                                                                              | 0/105 [00:00<?, ?it/s]/home/disi/ml/.venv/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass














Epoch 1 - Training: 100%|████████████████████████████████████████████████████████████████████| 105/105 [00:31<00:00,  3.37it/s]
2024-05-28 20:35:20,626 - training_logger - INFO - Training: Average loss: 3.8017, Accuracy: 10.97%
2024-05-28 20:35:20,626 - training_logger - INFO - Epoch 1 completed in 31.15 seconds
Validation:   0%|                                                                                      | 0/105 [00:00<?, ?it/s]




Validation:  87%|██████████████████████████████████████████████████████████████████▋          | 91/105 [00:08<00:01, 11.48it/s]
Training loss: 3.802, Training accuracy: 10.972
Validation loss: 4.637, Validation accuracy: 1.101
Validation: 100%|████████████████████████████████████████████████████████████████████████████| 105/105 [00:09<00:00, 11.08it/s]
2024-05-28 20:35:30,253 - training_logger - INFO - Model saved as /home/disi/ml/checkpoints/efficientnetv2_aircraft_try/efficientnetv2_aircraft_epoch1.pth















Epoch 2 - Training:  98%|██████████████████████████████████████████████████████████████████▋ | 103/105 [00:30<00:00,  3.39it/s]
Epoch 2 - Training: 100%|████████████████████████████████████████████████████████████████████| 105/105 [00:31<00:00,  3.38it/s]
2024-05-28 20:36:01,355 - training_logger - INFO - Training: Average loss: 3.9257, Accuracy: 7.98%
2024-05-28 20:36:01,355 - training_logger - INFO - Epoch 2 completed in 31.09 seconds



Validation: 100%|████████████████████████████████████████████████████████████████████████████| 105/105 [00:09<00:00, 11.22it/s]
2024-05-28 20:36:10,862 - training_logger - INFO - Model saved as /home/disi/ml/checkpoints/efficientnetv2_aircraft_try/efficientnetv2_aircraft_epoch2.pth
Epoch 3 - Training:   0%|                                                                              | 0/105 [00:00<?, ?it/s]
Training loss: 3.926, Training accuracy: 7.976
Validation loss: 4.406, Validation accuracy: 3.423













Epoch 3 - Training:  88%|████████████████████████████████████████████████████████████▍        | 92/105 [00:27<00:03,  3.31it/s]
Traceback (most recent call last):
  File "/home/disi/ml/intromlproject/training-main.py", line 177, in <module>
    main(config)
  File "/home/disi/ml/intromlproject/training-main.py", line 159, in main
    run_epochs(model = model,
  File "/home/disi/ml/intromlproject/training-main.py", line 50, in run_epochs
    train_loss, train_acc = train_model(model = model,
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/disi/ml/intromlproject/utils/training.py", line 18, in train_model
    images, labels = images.to(device), labels.to(device)
                     ^^^^^^^^^^^^^^^^^
KeyboardInterrupt