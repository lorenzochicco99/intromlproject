
[32m[I 2024-05-31 21:00:41,432][39m A new study created in memory with name: no-name-5d3965e8-7a2c-4415-a9d2-d044ec1792f3
Training phase ...
Epoch 1 - Training:   0%|                                                                                                                                                                                            | 0/257 [00:00<?, ?it/s]/home/disi/ml/.venv/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass




































Epoch 1 - Training:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 254/257 [01:19<00:00,  3.35it/s]
Epoch 1 - Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 257/257 [01:20<00:00,  3.19it/s]
2024-05-31 21:02:04,080 - training_logger - INFO - Training: Average loss: 3.2384, Accuracy: 23.52%
2024-05-31 21:02:04,084 - training_logger - INFO - Epoch 1 completed in 80.53 seconds


Validation:  98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋   | 55/56 [00:05<00:00, 11.82it/s]
Train loss: 3.238, Train accuracy: 23.517
Validation loss: 2.028, Validation accuracy: 43.638
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.56it/s]






































Epoch 2 - Training:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 254/257 [01:17<00:00,  3.22it/s]
Epoch 2 - Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 257/257 [01:18<00:00,  3.27it/s]
2024-05-31 21:03:28,046 - training_logger - INFO - Training: Average loss: 1.5183, Accuracy: 56.13%
2024-05-31 21:03:28,046 - training_logger - INFO - Epoch 2 completed in 78.50 seconds

Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 11.08it/s]
Epoch 3 - Training:   0%|                                                                                                                                                                                            | 0/257 [00:00<?, ?it/s]
Train loss: 1.518, Train accuracy: 56.128
Validation loss: 1.489, Validation accuracy: 57.589








































Epoch 3 - Training:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 254/257 [01:20<00:00,  3.16it/s]
Epoch 3 - Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 257/257 [01:20<00:00,  3.17it/s]
2024-05-31 21:04:54,225 - training_logger - INFO - Training: Average loss: 0.9105, Accuracy: 72.79%
2024-05-31 21:04:54,226 - training_logger - INFO - Epoch 3 completed in 80.97 seconds

Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.88it/s]
Epoch 4 - Training:   0%|                                                                                                                                                                                            | 0/257 [00:00<?, ?it/s]
Train loss: 0.911, Train accuracy: 72.787
Validation loss: 1.244, Validation accuracy: 65.179








































Epoch 4 - Training:  98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏  | 253/257 [01:20<00:01,  3.16it/s]
Epoch 4 - Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 257/257 [01:21<00:00,  3.16it/s]
2024-05-31 21:06:20,950 - training_logger - INFO - Training: Average loss: 0.5964, Accuracy: 81.24%
2024-05-31 21:06:20,950 - training_logger - INFO - Epoch 4 completed in 81.42 seconds


Validation:  91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                | 51/56 [00:04<00:00, 11.26it/s]
Train loss: 0.596, Train accuracy: 81.238
Validation loss: 1.203, Validation accuracy: 67.801
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.90it/s]








































Epoch 5 - Training:  99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌ | 255/257 [01:21<00:00,  3.16it/s]
Epoch 5 - Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 257/257 [01:21<00:00,  3.15it/s]
2024-05-31 21:07:47,841 - training_logger - INFO - Training: Average loss: 0.4315, Accuracy: 86.89%
2024-05-31 21:07:47,842 - training_logger - INFO - Epoch 5 completed in 81.59 seconds

Validation:  66%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                               | 37/56 [00:03<00:01, 11.18it/s]
Train loss: 0.432, Train accuracy: 86.892
Validation loss: 1.300, Validation accuracy: 66.741
Validation: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.90it/s]








































Epoch 6 - Training:  98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏  | 253/257 [01:20<00:01,  3.14it/s]
Epoch 6 - Training: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 257/257 [01:21<00:00,  3.16it/s]
2024-05-31 21:09:14,536 - training_logger - INFO - Training: Average loss: 0.3263, Accuracy: 90.14%
2024-05-31 21:09:14,536 - training_logger - INFO - Epoch 6 completed in 81.40 seconds


Validation:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 53/56 [00:04<00:00, 11.19it/s]
Train loss: 0.326, Train accuracy: 90.139
Validation loss: 1.322, Validation accuracy: 66.853
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.90it/s]







































Epoch 7 - Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 257/257 [01:21<00:00,  3.15it/s]
2024-05-31 21:10:41,315 - training_logger - INFO - Training: Average loss: 0.2857, Accuracy: 91.54%
2024-05-31 21:10:41,315 - training_logger - INFO - Epoch 7 completed in 81.48 seconds
Validation:   0%|                                                                                                                                                                                                                   | 0/56 [00:00<?, ?it/s]


Validation:  77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                               | 43/56 [00:04<00:01, 10.87it/s]
Train loss: 0.286, Train accuracy: 91.537
Validation loss: 1.383, Validation accuracy: 67.801
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.18it/s]








































Epoch 8 - Training:  98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 253/257 [01:20<00:01,  3.08it/s]
Epoch 8 - Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 257/257 [01:21<00:00,  3.14it/s]
2024-05-31 21:12:08,948 - training_logger - INFO - Training: Average loss: 0.2714, Accuracy: 92.13%
2024-05-31 21:12:08,948 - training_logger - INFO - Epoch 8 completed in 81.78 seconds


Validation:  89%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                     | 50/56 [00:04<00:00, 11.10it/s]
Train loss: 0.271, Train accuracy: 92.133
Validation loss: 1.312, Validation accuracy: 69.643
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.35it/s]








































Epoch 9 - Training:  99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊  | 254/257 [01:20<00:00,  3.07it/s]
Epoch 9 - Training: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 257/257 [01:21<00:00,  3.14it/s]
2024-05-31 21:13:36,380 - training_logger - INFO - Training: Average loss: 0.2209, Accuracy: 93.43%
2024-05-31 21:13:36,380 - training_logger - INFO - Epoch 9 completed in 81.80 seconds


Validation:  96%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊       | 54/56 [00:05<00:00, 10.88it/s]
Train loss: 0.221, Train accuracy: 93.434
Validation loss: 1.448, Validation accuracy: 67.634
Best hyperparameters: {'dropout_rate': 0.28445368272301286, 'optimizer': 'AdamW', 'learning_rate': 0.0007810351887654089, 'weight_decay': 1.4250161616192003e-05}
Study statistics:
  Number of finished trials:  1
  Number of pruned trials:  0
Validation: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.36it/s]
[32m[I 2024-05-31 21:13:42,132][39m Trial 0 finished with value: 67.63392857142857 and parameters: {'dropout_rate': 0.28445368272301286, 'optimizer': 'AdamW', 'learning_rate': 0.0007810351887654089, 'weight_decay': 1.4250161616192003e-05}. Best is trial 0 with value: 67.63392857142857.
Traceback (most recent call last):
  File "/home/disi/ml/intromlproject/training-main-optune.py", line 173, in <module>
    main(config)
  File "/home/disi/ml/intromlproject/training-main-optune.py", line 139, in main
    param_importance_plot = optuna.visualization.plot_param_importances(study)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/disi/ml/.venv/lib/python3.11/site-packages/optuna/visualization/_param_importances.py", line 191, in plot_param_importances
    importances_infos = _get_importances_infos(study, evaluator, params, target, target_name)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/disi/ml/.venv/lib/python3.11/site-packages/optuna/visualization/_param_importances.py", line 82, in _get_importances_infos
    _get_importances_info(
  File "/home/disi/ml/.venv/lib/python3.11/site-packages/optuna/visualization/_param_importances.py", line 54, in _get_importances_info
    importances = optuna.importance.get_param_importances(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/disi/ml/.venv/lib/python3.11/site-packages/optuna/importance/__init__.py", line 113, in get_param_importances
    res = evaluator.evaluate(study, params=params, target=target)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/disi/ml/.venv/lib/python3.11/site-packages/optuna/importance/_fanova/_evaluator.py", line 92, in evaluate
    distributions = _get_distributions(study, params=params)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/disi/ml/.venv/lib/python3.11/site-packages/optuna/importance/_base.py", line 71, in _get_distributions
    _check_evaluate_args(completed_trials, params)
  File "/home/disi/ml/.venv/lib/python3.11/site-packages/optuna/importance/_base.py", line 116, in _check_evaluate_args
    raise ValueError("Cannot evaluate parameter importances with only a single trial.")
ValueError: Cannot evaluate parameter importances with only a single trial.