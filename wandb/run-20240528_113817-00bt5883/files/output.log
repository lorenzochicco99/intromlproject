Data loaded correctly
number of classes 70
Optimizer SGD (
Parameter Group 0
    dampening: 0
    differentiable: False
    foreach: None
    fused: None
    lr: 1.2374090114493525e-05
    maximize: False
    momentum: 0.736045219441998
    nesterov: False
    weight_decay: 0.00749219669136411
)
Training phase ...
2024-05-28 11:38:18,443 - training_logger - INFO - Configurations: {'root': '/home/disi/ml', 'img_folder': 'aircraft', 'model_name': 'efficientnetv2', 'data_dir': '/home/disi/ml/datasets/aircraft', 'dataset_name': 'aircraft', 'checkpoint': None, 'save_dir': '/home/disi/ml/checkpoints/efficientnetv2_aircraft', 'project_name': 'efficientnetv2_test', 'image_size': 224, 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225], 'batch_size': 42, 'epochs': 10, 'optimizer': 'SGD', 'optimizer_type': 'simple', 'learning_rate': 1.2374090114493525e-05, 'weight_decay': 0.00749219669136411, 'momentum': 0.736045219441998, 'criterion': 'CrossEntropyLoss', 'scheduler': True, 'step_size': 10, 'patience': 5, 'dropout_rate': 0.3317332509897824, 'device': 'cuda'}
Epoch 1 - Training:   0%|                                                                                                                                                                                                                          | 0/80 [00:00<?, ?it/s]/home/disi/ml/.venv/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass















Epoch 1 - Training:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 76/80 [00:31<00:01,  2.45it/s]
Epoch 1 - Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [00:33<00:00,  2.42it/s]
2024-05-28 11:38:51,573 - training_logger - INFO - Training: Average loss: 4.2629, Accuracy: 1.16%
2024-05-28 11:38:51,573 - training_logger - INFO - Epoch 1 completed in 33.12 seconds




Validation:  84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                 | 67/80 [00:08<00:01,  8.49it/s]
Training loss: 4.263, Training accuracy: 1.161
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [00:09<00:00,  8.07it/s]
2024-05-28 11:39:01,814 - training_logger - INFO - Model saved as /home/disi/ml/checkpoints/efficientnetv2_aircraft/efficientnetv2_aircraft_epoch1.pth
Epoch 2 - Training:   0%|                                                                                                                                                                                                              | 0/80 [00:00<?, ?it/s]
















Epoch 2 - Training:  96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌       | 77/80 [00:32<00:01,  2.42it/s]
Epoch 2 - Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [00:33<00:00,  2.40it/s]
2024-05-28 11:39:35,101 - training_logger - INFO - Training: Average loss: 4.2648, Accuracy: 1.42%
2024-05-28 11:39:35,101 - training_logger - INFO - Epoch 2 completed in 33.28 seconds




Validation:  88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                         | 70/80 [00:08<00:01,  8.33it/s]
Training loss: 4.265, Training accuracy: 1.417
Validation loss: 4.259, Validation accuracy: 1.488
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [00:10<00:00,  7.95it/s]
2024-05-28 11:39:45,490 - training_logger - INFO - Model saved as /home/disi/ml/checkpoints/efficientnetv2_aircraft/efficientnetv2_aircraft_epoch2.pth
















Epoch 3 - Training:  96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌       | 77/80 [00:32<00:01,  2.39it/s]
Epoch 3 - Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [00:33<00:00,  2.38it/s]
2024-05-28 11:40:19,069 - training_logger - INFO - Training: Average loss: 4.2678, Accuracy: 1.43%
2024-05-28 11:40:19,069 - training_logger - INFO - Epoch 3 completed in 33.57 seconds




Validation:  89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                       | 71/80 [00:09<00:01,  8.25it/s]
Training loss: 4.268, Training accuracy: 1.429
Validation loss: 4.258, Validation accuracy: 1.369
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [00:10<00:00,  7.92it/s]
2024-05-28 11:40:29,506 - training_logger - INFO - Model saved as /home/disi/ml/checkpoints/efficientnetv2_aircraft/efficientnetv2_aircraft_epoch3.pth
















Epoch 4 - Training:  96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌       | 77/80 [00:32<00:01,  2.37it/s]
Epoch 4 - Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [00:33<00:00,  2.36it/s]
2024-05-28 11:41:03,433 - training_logger - INFO - Training: Average loss: 4.2615, Accuracy: 1.49%
2024-05-28 11:41:03,433 - training_logger - INFO - Epoch 4 completed in 33.92 seconds




Validation:  85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                              | 68/80 [00:08<00:01,  8.17it/s]
Training loss: 4.262, Training accuracy: 1.488
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [00:10<00:00,  7.83it/s]
2024-05-28 11:41:13,978 - training_logger - INFO - Model saved as /home/disi/ml/checkpoints/efficientnetv2_aircraft/efficientnetv2_aircraft_epoch4.pth
Epoch 5 - Training:   0%|                                                                                                                                                                                                              | 0/80 [00:00<?, ?it/s]
















Epoch 5 - Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [00:34<00:00,  2.35it/s]
2024-05-28 11:41:48,101 - training_logger - INFO - Training: Average loss: 4.2559, Accuracy: 1.37%
2024-05-28 11:41:48,101 - training_logger - INFO - Epoch 5 completed in 34.11 seconds
Validation:   0%|                                                                                                                                                                                                                      | 0/80 [00:00<?, ?it/s]





Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [00:10<00:00,  7.82it/s]
Training loss: 4.256, Training accuracy: 1.369
Validation loss: 4.255, Validation accuracy: 1.399
Training phase ...
2024-05-28 11:41:58,572 - training_logger - INFO - Model saved as /home/disi/ml/checkpoints/efficientnetv2_aircraft/efficientnetv2_aircraft_epoch5.pth
















Epoch 6 - Training:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌  | 79/80 [00:33<00:00,  2.35it/s]
Epoch 6 - Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [00:34<00:00,  2.34it/s]
2024-05-28 11:42:32,816 - training_logger - INFO - Training: Average loss: 4.2598, Accuracy: 1.46%
2024-05-28 11:42:32,816 - training_logger - INFO - Epoch 6 completed in 34.23 seconds




Validation:  94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏            | 75/80 [00:09<00:00,  8.17it/s]
Training loss: 4.260, Training accuracy: 1.458
Validation loss: 4.254, Validation accuracy: 1.399
Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [00:10<00:00,  7.79it/s]
2024-05-28 11:42:43,414 - training_logger - INFO - Model saved as /home/disi/ml/checkpoints/efficientnetv2_aircraft/efficientnetv2_aircraft_epoch6.pth
















Epoch 7 - Training: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [00:34<00:00,  2.33it/s]
2024-05-28 11:43:17,771 - training_logger - INFO - Training: Average loss: 4.2556, Accuracy: 1.58%
2024-05-28 11:43:17,771 - training_logger - INFO - Epoch 7 completed in 34.35 seconds
Validation:   4%|███████▋                                                                                                                                                                                                      | 3/80 [00:00<00:17,  4.51it/s]




Validation: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 80/80 [00:10<00:00,  7.78it/s]
2024-05-28 11:43:28,386 - training_logger - INFO - Model saved as /home/disi/ml/checkpoints/efficientnetv2_aircraft/efficientnetv2_aircraft_epoch7.pth
Epoch 8 - Training:   0%|                                                                                                                                                                                                              | 0/80 [00:00<?, ?it/s]
Training loss: 4.256, Training accuracy: 1.577
Validation loss: 4.253, Validation accuracy: 1.518



Epoch 8 - Training:  18%|██████████████████████████████████▍                                                                                                                                                                  | 14/80 [00:06<00:30,  2.16it/s]
Traceback (most recent call last):
  File "/home/disi/ml/intromlproject/training-main2.py", line 168, in <module>
    main(config)
  File "/home/disi/ml/intromlproject/training-main2.py", line 150, in main
    run_epochs(model = model,
  File "/home/disi/ml/intromlproject/training-main2.py", line 48, in run_epochs
    train_loss, train_acc = train_model(model = model,
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/disi/ml/intromlproject/utils/training2.py", line 18, in train_model
    images, labels = images.to(device), labels.to(device)
                     ^^^^^^^^^^^^^^^^^
KeyboardInterrupt