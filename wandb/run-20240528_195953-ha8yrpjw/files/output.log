Data loaded correctly
number of classes 70
2024-05-28 19:59:56,312 - training_logger - INFO - Configurations: {'root': '/home/disi/ml', 'img_folder': 'aircraft', 'model_name': 'efficientnetv2', 'data_dir': '/home/disi/ml/datasets/aircraft', 'dataset_name': 'aircraft', 'checkpoint': None, 'save_dir': '/home/disi/ml/checkpoints/efficientnetv2_aircraft_try', 'project_name': 'efficientnetv2_test', 'image_size': 224, 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225], 'batch_size': 42, 'epochs': 20, 'optimizer': 'SGD', 'optimizer_type': 'simple', 'learning_rate': 1.2374090114493525e-05, 'weight_decay': 0.00749219669136411, 'momentum': 0.736045219441998, 'criterion': 'CrossEntropyLoss', 'scheduler': True, 'step_size': 10, 'patience': 5, 'dropout_rate': 0.3317332509897824, 'device': 'cuda'}
Epoch 1 - Training:   0%|                                                                        | 0/80 [00:00<?, ?it/s]
Optimizer SGD (
Parameter Group 0
    dampening: 0
    differentiable: False
    foreach: None
    fused: None
    lr: 1.2374090114493525e-05
    maximize: False
    momentum: 0.736045219441998
    nesterov: False
    weight_decay: 0.00749219669136411
)
Epoch 1 - Training:   0%|                                                                        | 0/80 [00:00<?, ?it/s]/home/disi/ml/.venv/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass













Epoch 1 - Training: 100%|███████████████████████████████████████████████████████████████| 80/80 [00:35<00:00,  2.28it/s]
2024-05-28 20:00:31,410 - training_logger - INFO - Training: Average loss: 4.2697, Accuracy: 1.52%
2024-05-28 20:00:31,410 - training_logger - INFO - Epoch 1 completed in 35.09 seconds
Validation:   0%|                                                                                | 0/80 [00:00<?, ?it/s]









Validation: 100%|███████████████████████████████████████████████████████████████████████| 80/80 [00:18<00:00,  4.29it/s]
2024-05-28 20:00:50,206 - training_logger - INFO - Model saved as /home/disi/ml/checkpoints/efficientnetv2_aircraft_try/efficientnetv2_aircraft_epoch1.pth
Epoch 2 - Training:   4%|██▍                                                             | 3/80 [00:01<00:31,  2.41it/s]
Training loss: 4.270, Training accuracy: 1.518
Validation loss: 4.260, Validation accuracy: 1.690














Epoch 2 - Training: 100%|███████████████████████████████████████████████████████████████| 80/80 [00:30<00:00,  2.66it/s]
2024-05-28 20:01:20,285 - training_logger - INFO - Training: Average loss: 4.2674, Accuracy: 1.43%
2024-05-28 20:01:20,285 - training_logger - INFO - Epoch 2 completed in 30.07 seconds
Validation:  11%|████████                                                                | 9/80 [00:01<00:10,  6.87it/s]




Validation: 100%|███████████████████████████████████████████████████████████████████████| 80/80 [00:09<00:00,  8.43it/s]
Training loss: 4.267, Training accuracy: 1.429
Validation loss: 4.259, Validation accuracy: 1.571
Training phase ...
2024-05-28 20:01:29,926 - training_logger - INFO - Model saved as /home/disi/ml/checkpoints/efficientnetv2_aircraft_try/efficientnetv2_aircraft_epoch2.pth














Epoch 3 - Training: 100%|███████████████████████████████████████████████████████████████| 80/80 [00:30<00:00,  2.62it/s]
2024-05-28 20:02:00,528 - training_logger - INFO - Training: Average loss: 4.2646, Accuracy: 1.40%
2024-05-28 20:02:00,529 - training_logger - INFO - Epoch 3 completed in 30.59 seconds
Validation:  10%|███████▏                                                                | 8/80 [00:01<00:09,  7.74it/s]




Validation: 100%|███████████████████████████████████████████████████████████████████████| 80/80 [00:09<00:00,  8.34it/s]
2024-05-28 20:02:10,276 - training_logger - INFO - Model saved as /home/disi/ml/checkpoints/efficientnetv2_aircraft_try/efficientnetv2_aircraft_epoch3.pth
Epoch 4 - Training:   4%|██▍                                                             | 3/80 [00:01<00:34,  2.22it/s]
Training loss: 4.265, Training accuracy: 1.399
Validation loss: 4.258, Validation accuracy: 1.780






Epoch 4 - Training:  42%|██████████████████████████▊                                    | 34/80 [00:13<00:18,  2.48it/s]
Traceback (most recent call last):
  File "/home/disi/ml/intromlproject/training-main2.py", line 168, in <module>
    main(config)
  File "/home/disi/ml/intromlproject/training-main2.py", line 150, in main
    run_epochs(model = model,
  File "/home/disi/ml/intromlproject/training-main2.py", line 48, in run_epochs
    train_loss, train_acc = train_model(model = model,
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/disi/ml/intromlproject/utils/training2.py", line 21, in train_model
    train_loss += loss.item()
                  ^^^^^^^^^^^
KeyboardInterrupt