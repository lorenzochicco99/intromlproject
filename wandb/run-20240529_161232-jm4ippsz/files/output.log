[32m[I 2024-05-29 16:12:32,889][39m A new study created in memory with name: no-name-07e51210-5128-4b21-b94a-9f58d208250f
Epoch 1 - Training:   0%|                                                                       | 0/257 [00:00<?, ?it/s]/home/disi/ml/.venv/lib/python3.11/site-packages/torch/autograd/graph.py:744: UserWarning: Plan failed with a cudnnException: CUDNN_BACKEND_EXECUTION_PLAN_DESCRIPTOR: cudnnFinalize Descriptor Failed cudnn_status: CUDNN_STATUS_NOT_SUPPORTED (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:919.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
Epoch 1 - Training:   0%|▏                                                              | 1/257 [00:01<04:16,  1.00s/it]








































Epoch 1 - Training: 100%|█████████████████████████████████████████████████████████████| 257/257 [01:21<00:00,  3.15it/s]
2024-05-29 16:13:55,185 - training_logger - INFO - Training: Average loss: 4.0537, Accuracy: 9.98%
2024-05-29 16:13:55,186 - training_logger - INFO - Epoch 1 completed in 81.71 seconds
Validation:  23%|████████████████▍                                                      | 13/56 [00:01<00:04, 10.65it/s]

Validation: 100%|███████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.69it/s]
Epoch 2 - Training:   0%|                                                                       | 0/257 [00:00<?, ?it/s]
Train loss: 4.054, Train accuracy: 9.983
Validation loss: 3.114, Validation accuracy: 21.317









































Epoch 2 - Training: 100%|█████████████████████████████████████████████████████████████| 257/257 [01:22<00:00,  3.10it/s]
2024-05-29 16:15:23,535 - training_logger - INFO - Training: Average loss: 2.6675, Accuracy: 29.75%
2024-05-29 16:15:23,535 - training_logger - INFO - Epoch 2 completed in 82.95 seconds
Validation:  16%|███████████▌                                                            | 9/56 [00:01<00:04, 10.01it/s]


Validation:  95%|███████████████████████████████████████████████████████████████████▏   | 53/56 [00:05<00:00, 10.97it/s]
Train loss: 2.667, Train accuracy: 29.754
Validation loss: 2.527, Validation accuracy: 33.929
Validation: 100%|███████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.63it/s]









































Epoch 3 - Training: 100%|████████████████████████████████████████████████████████████▊| 256/257 [01:23<00:00,  3.04it/s]
Epoch 3 - Training: 100%|█████████████████████████████████████████████████████████████| 257/257 [01:23<00:00,  3.06it/s]
2024-05-29 16:16:52,914 - training_logger - INFO - Training: Average loss: 1.8841, Accuracy: 47.64%
2024-05-29 16:16:52,914 - training_logger - INFO - Epoch 3 completed in 83.95 seconds

Validation: 100%|███████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.53it/s]
Epoch 4 - Training:   0%|▏                                                              | 1/257 [00:00<01:26,  2.96it/s]
Train loss: 1.884, Train accuracy: 47.641
Validation loss: 1.920, Validation accuracy: 49.219









































Epoch 4 - Training: 100%|█████████████████████████████████████████████████████████████| 257/257 [01:24<00:00,  3.04it/s]
2024-05-29 16:18:22,841 - training_logger - INFO - Training: Average loss: 1.3552, Accuracy: 60.64%
2024-05-29 16:18:22,842 - training_logger - INFO - Epoch 4 completed in 84.45 seconds
Validation:   0%|                                                                                | 0/56 [00:00<?, ?it/s]


Validation: 100%|███████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.55it/s]
[32m[I 2024-05-29 16:18:28,306][39m Trial 0 finished with value: 46.707589285714285 and parameters: {'dropout_rate': 0.4704610106127725, 'optimizer': 'AdamW', 'learning_rate': 0.0015534590993351726, 'weight_decay': 1.3840815650438413e-06}. Best is trial 0 with value: 46.707589285714285.
Epoch 1 - Training:   0%|                                                                       | 0/257 [00:00<?, ?it/s]
Train loss: 1.355, Train accuracy: 60.640
Validation loss: 2.059, Validation accuracy: 46.708









































Epoch 1 - Training: 100%|█████████████████████████████████████████████████████████████| 257/257 [01:24<00:00,  3.06it/s]
2024-05-29 16:19:52,714 - training_logger - INFO - Training: Average loss: 5.3116, Accuracy: 0.72%
2024-05-29 16:19:52,715 - training_logger - INFO - Epoch 1 completed in 84.02 seconds
Validation:   0%|                                                                                | 0/56 [00:00<?, ?it/s]


Validation: 100%|███████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.46it/s]
Epoch 2 - Training:   1%|▍                                                              | 2/257 [00:00<01:23,  3.04it/s]
Train loss: 5.312, Train accuracy: 0.717
Validation loss: 5.300, Validation accuracy: 0.949









































Epoch 2 - Training: 100%|█████████████████████████████████████████████████████████████| 257/257 [01:24<00:00,  3.05it/s]
2024-05-29 16:21:22,457 - training_logger - INFO - Training: Average loss: 5.3127, Accuracy: 0.66%
2024-05-29 16:21:22,457 - training_logger - INFO - Epoch 2 completed in 84.22 seconds
Validation:   5%|███▊                                                                    | 3/56 [00:00<00:07,  6.76it/s]


Validation: 100%|███████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.40it/s]
Epoch 3 - Training:   1%|▋                                                              | 3/257 [00:00<01:23,  3.04it/s]
Train loss: 5.313, Train accuracy: 0.657
Validation loss: 5.298, Validation accuracy: 0.670









































Epoch 3 - Training: 100%|█████████████████████████████████████████████████████████████| 257/257 [01:24<00:00,  3.04it/s]
2024-05-29 16:22:52,410 - training_logger - INFO - Training: Average loss: 5.3065, Accuracy: 0.63%
2024-05-29 16:22:52,410 - training_logger - INFO - Epoch 3 completed in 84.40 seconds
Validation:   9%|██████▍                                                                 | 5/56 [00:00<00:06,  8.48it/s]


Validation: 100%|███████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.44it/s]
Epoch 4 - Training:   1%|▋                                                              | 3/257 [00:00<01:22,  3.07it/s]
Train loss: 5.306, Train accuracy: 0.632
Validation loss: 5.306, Validation accuracy: 0.614









































Epoch 4 - Training: 100%|█████████████████████████████████████████████████████████████| 257/257 [01:24<00:00,  3.04it/s]
2024-05-29 16:24:22,348 - training_logger - INFO - Training: Average loss: 5.3077, Accuracy: 0.73%
2024-05-29 16:24:22,348 - training_logger - INFO - Epoch 4 completed in 84.41 seconds
Validation:  12%|█████████                                                               | 7/56 [00:00<00:05,  9.33it/s]


Validation: 100%|███████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 10.45it/s]
[32m[I 2024-05-29 16:24:27,864][39m Trial 1 finished with value: 0.78125 and parameters: {'dropout_rate': 0.43880063130130587, 'optimizer': 'SGD', 'learning_rate': 1.1034106295455964e-05, 'weight_decay': 0.004254925346876733, 'momentum': 0.523216445621923}. Best is trial 0 with value: 46.707589285714285.
Train loss: 5.308, Train accuracy: 0.730
Validation loss: 5.301, Validation accuracy: 0.781
Best hyperparameters: {'dropout_rate': 0.4704610106127725, 'optimizer': 'AdamW', 'learning_rate': 0.0015534590993351726, 'weight_decay': 1.3840815650438413e-06}
Study statistics:
  Number of finished trials:  2
  Number of pruned trials:  0
  Number of complete trials:  2
Train the model efficientnetv2 with the best hyperparameters found with Optuna... {'dropout_rate': 0.4704610106127725, 'optimizer': 'AdamW', 'learning_rate': 0.0015534590993351726, 'weight_decay': 1.3840815650438413e-06}
Config {'root': '/home/disi/ml', 'img_folder': 'CUB_200_2011', 'model_name': 'efficientnetv2', 'data_dir': '/home/disi/ml/datasets/CUB_200_2011', 'dataset_name': 'CUB_200_2011', 'checkpoint': None, 'save_dir': '/home/disi/ml/checkpoints/efficientnetv2_CUB_200_2011', 'project_name': 'efficientnetv2_test', 'image_size': 224, 'mean': [0.485, 0.456, 0.406], 'std': [0.229, 0.224, 0.225], 'batch_size': 32, 'epochs': 5, 'optimizer': 'AdamW', 'optimizer_type': 'custom', 'learning_rate': 1e-05, 'weight_decay': 0.01, 'momentum': 0.736045219441998, 'criterion': 'CrossEntropyLoss', 'scheduler': True, 'step_size': 10, 'patience': 5, 'dropout_rate': 0.3317332509897824, 'device': 'cuda'}